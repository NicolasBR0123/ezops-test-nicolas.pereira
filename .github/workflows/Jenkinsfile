pipeline {
    agent any
   tools {
       maven 'maven'
       jdk 'Java'
   }  
  
   enviroment {
       dockerhub=credentials('dockerhub')
   }


   stage('build image')
    {
        when{
            brench "main"
            }
        steps{
            sh 'docker build -t web-chat:18.04'
        }
    }
    stage(pushing to dockerhub)
        when{
            brench "main"
        }
        steps{
            sh 'docker tag web-chat:18.04 448986393877782883328382439534/web-chat:18.04'
            sh 'echo $dockerhub_PSW | docker login -u $dockerhub_USR --password-stdin'

            sh 'docker push 448986393877782883328382439534/web-chat:18.04'
        }
}

